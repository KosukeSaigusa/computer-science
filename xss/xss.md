# XSS（クロスサイトスクリプティング）

## 参考

- [栢木先生の基本情報技術者教室](https://www.amazon.co.jp/dp/B0821W2G51/ref=dp-kindle-redirect?_encoding=UTF8&btkr=1)
- [カゴヤのサーバー研究室 クロスサイトスクリプティングって何？サイトのセキュリティを高めるために](https://www.kagoya.jp/howto/network/xss/)
- [Canon Web アプリケーションファイアーウォール](https://cweb.canon.jp/it-sec/solution/siteguard/waf/)

## XSS とは

XSS とは、掲示板やタイムライン、商品ページのように、入力・投稿した内容がそのまま表示される Web サイトに脆弱性がある場合に、悪意のある罠を実行させるスクリプトをそのようなサイトに埋め込むことで、他のユーザーに罠を踏ませ、Cookie の漏洩や偽のサイトでの個人情報の収集を行う攻撃のことをいう。

## XSS の仕組み

学習中。

## XSS の対策

XSS 攻撃を防ぐための対策として次のようなものがある。

1. 入力値のバリデーション
2. サニタイジング (sanitizing)
3. WAF (Web Application Firewall) の設定

### XSS の対策 1

XSS 攻撃では、悪意のあるユーザーが不正なスクリプトを埋め込もうとするため、最初にそれを防ぐ方法として入力値のバリデーションがある。たとえば、郵便番号を入力するフォームでは、数字以外の文字種を入力できないように制限する、といった対応である。しかし、クライアント側のバリデーションは比較的容易に回避することが可能なので、いずれにせよサーバ側での対応が必須となることは認識しておく必要がある。

### XSS の対策 2

サニタイジング (sanitizing) とは、入力値として不正なスクリプトの構成に必要となる文字が入力された場合に、その文字を別の文字へ書き換える手法を意味する。たとえば、スクリプトタグに使用される `<` や `>` といった特殊文字はそれぞれ `&gt;` (greater than) や `&lt;` (less than) に変換することで、それらを無効化する。

### XSS の対策 3

WAF とは "Web Application Firewall" の略で、Web アプリケーションの脆弱性を悪用した攻撃から Web サイトを保護するセキュリティ対策を指す。クライアントとサーバーの間に設置して通信やその内容を検査し、不適切なものを遮断することで Web サイトやデータを保護する。Firebase の Cloud Firestore で言うところの Security Rules がこれに相当すると言って良い。ユーザーから送られてきた入力内容を、DB に保存する前に解析・検査し、不適切な文字列や悪意のあるスクリプトと判断される内容が含まれていた場合には、それをシャットアウトするという対策である。
